<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="随记">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="随记">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Irvin">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>随记</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">随记</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/04/HashMap%E5%92%8CHashTable/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Irvin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="随记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/04/HashMap%E5%92%8CHashTable/" class="post-title-link" itemprop="url">HashMap和HashTable.md</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-04 14:42:31" itemprop="dateCreated datePublished" datetime="2021-03-04T14:42:31+08:00">2021-03-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-04 15:53:06" itemprop="dateModified" datetime="2021-08-04T15:53:06+08:00">2021-08-04</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="HashMap和HashTable的区别？"><a href="#HashMap和HashTable的区别？" class="headerlink" title="HashMap和HashTable的区别？"></a>HashMap和HashTable的区别？</h4><ol>
<li><p>线程安全</p>
<ol>
<li><p>HashTable是线程安全的，HashMap是线程不安全的。</p>
</li>
<li><p>之所以说HashTable是线程安全的是因为它所有的操作元素都是synchronized修饰的，而HashMap并没有。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*-----HashTable--------*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> V <span class="title">put</span><span class="params">(K key, V value)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> V <span class="title">get</span><span class="params">(Object key)</span></span>&#123;&#125;</span><br><span class="line"><span class="comment">/*-----HashMap--------*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>性能优劣</p>
<ol>
<li>HashTable是线程安全的，每个方法都要阻塞其他线程，所以HashTable性能比较差。</li>
<li>HashMap性能比较好，使用更广。</li>
<li>如果既要保证线程安全又要保证性能的话，建议使用JUC包下的ConcurrentHashMap。</li>
</ol>
</li>
<li><p>NULL</p>
<ol>
<li><p>HashTable是不允许键或值为null的，HashMap的键值则都可以为null。</p>
</li>
<li><p>Hashtable使用put方法的时候是不允许KEY和VALUE为null的，而HashMap则可以。原因是Hashtable如果Key为null的时候会直接抛出空指针异常，value为null的时候手动抛出了异常。HashMap则针对null做了特殊的处理</p>
<ol>
<li>```java<br>/<em>HashTable的put方法</em>/<br>public synchronized V put(K key, V value) {<pre><code>    // Make sure the value is not null
    if (value == null) &#123;
        throw new NullPointerException();
    &#125;
    // Makes sure the key is not already in the hashtable.
    Entry&lt;?,?&gt; tab[] = table;
    int hash = key.hashCode();
    ...
</code></pre>
}<br>/* HashMap的hash方法*/<br>static final int hash(Object key) {<pre><code>    int h;
    return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);
</code></pre>
}<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">4. 实现方式</span><br><span class="line"></span><br><span class="line">   1. HashTable继承了Dictionary类，HashMap继承了AbstractMap类</span><br><span class="line"></span><br><span class="line">      1. ```java</span><br><span class="line">         /*HashMap*/</span><br><span class="line">         public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt;</span><br><span class="line">             implements Map&lt;K,V&gt;, Cloneable, Serializable &#123;&#125;</span><br><span class="line">         /*Hashtable*/</span><br><span class="line">         public class Hashtable&lt;K,V&gt;</span><br><span class="line">             extends Dictionary&lt;K,V&gt;</span><br><span class="line">             implements Map&lt;K,V&gt;, Cloneable, java.io.Serializable &#123;&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
<li><p>容量扩容</p>
<ol>
<li><p>HashMap的初始容量为16，HashTable的初始容量为11，两者的负载因子都为0.75。当现有容量大于总容量*负载因子的时候，HashMap的扩容规则为当前容量翻倍，而HashTable的扩容规则为当前容量翻倍+1。</p>
<ol>
<li><pre><code class="java">/*Hashtable*/
public Hashtable() &#123;
  this(11, 0.75f);
&#125;
/*HashMap*/
static final float DEFAULT_LOAD_FACTOR = 0.75f;
public HashMap() &#123;
  this.loadFactor = DEFAULT_LOAD_FACTOR; // all other fields defaulted
&#125;
</code></pre>
</li>
</ol>
</li>
</ol>
</li>
<li><p>迭代器</p>
<ol>
<li>HashMap中的Iterator迭代器是fail-fast的，而HashTable的Enumerator不是fail-fast的。所以当其他线程改变了HashMap的结构，例如：增加、删除、将会抛出ConcurrentModificationException异常，而HashTable则不会。</li>
</ol>
</li>
<li><p>替代品</p>
<ol>
<li>ConcurrenthashMap：<ol>
<li>ConcurrentHashMap是JDK1.5添加的新集合，用来保证线程安全性，提升Map集合的并发效率。ConcurrentHashmap使用了Segment的概念，默认是有16个Segment，Segment里面依然还是数组+链表的数据结构，相当于给HashMap分桶处理了，因此每次只会锁住其中一个Segment，所以性能非常好。然而随着</li>
<li>JDK1.8中对HashMap的改进，同时又对Concurrenthashmap进行了改进，抛弃了Segment+数组+单向链表的设计，改为了和HashMap同样的数组+链表+红黑树的数据结构</li>
<li>ConcurrentHashMap使用了CAS算法 + Synchronized 来保证集合的线程安全性，ConcurrentHashMap相当于一个性能安全的HashMap。</li>
</ol>
</li>
</ol>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/25/Docker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Irvin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="随记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/25/Docker/" class="post-title-link" itemprop="url">Docker</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-25 14:40:24" itemprop="dateCreated datePublished" datetime="2020-12-25T14:40:24+08:00">2020-12-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-04 15:52:53" itemprop="dateModified" datetime="2021-08-04T15:52:53+08:00">2021-08-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Docker安装过程记录</p>
<h3 id="Docker通用命令"><a href="#Docker通用命令" class="headerlink" title="Docker通用命令"></a>Docker通用命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker images 							#查询已安装的镜像</span><br><span class="line">docker ps 									#查询启动的容器</span><br><span class="line">docker rm 容器ID						 #删除容器</span><br><span class="line">docker stop 容器ID					 #停止容器</span><br><span class="line">docker container update --restart=always 容器名字			#自启容器</span><br></pre></td></tr></table></figure>



<h3 id="Docker安装redis"><a href="#Docker安装redis" class="headerlink" title="Docker安装redis"></a>Docker安装redis</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker search redis					#查询redis版本号</span><br><span class="line">docker pull redis:latest		#下载redis最新镜像</span><br><span class="line">docker images 							#查询已安装的镜像</span><br><span class="line">docker run -itd --name redis-test -p 6379:6379 redis   #左边主机端口，右边宿主机端口，通过指定才可以在本机连接</span><br><span class="line">docker ps 									#查询启动的容器</span><br><span class="line">docker rm 容器ID						 #删除容器</span><br><span class="line">docker stop 容器ID					 #停止容器</span><br><span class="line">docker exec -it redis-test /bin/bash	 redis-cli 	# 通过redis-cli连接测试redis服务</span><br></pre></td></tr></table></figure>

<h3 id="Docker安装rabbitmq"><a href="#Docker安装rabbitmq" class="headerlink" title="Docker安装rabbitmq"></a>Docker安装rabbitmq</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker pull rabbitmq:management  # 下载rabbitmq:management镜像</span><br><span class="line">docker run -d --hostname my-rabbit --name rabbit -e RABBITMQ_DEFAULT_USER=admin -e RABBITMQ_DEFAULT_PASS=admin -p 15672:15672 -p 5672:5672 -p 25672:25672 -p 61613:61613 -p 1883:1883 rabbitmq:management			#启动redis并设置用户名密码</span><br><span class="line">docker logs rabbit			#查看rabbit的运行情况</span><br></pre></td></tr></table></figure>

<h4 id="Docker安装nacos"><a href="#Docker安装nacos" class="headerlink" title="Docker安装nacos"></a>Docker安装nacos</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker search nacos			#查找nacos镜像</span><br><span class="line">docker pull nacos/nacos-server		#安装nacos</span><br><span class="line">docker run --env MODE=standalone --name nacos -d -p 28848:28848 nacos/nacos-server		#启动nacos</span><br></pre></td></tr></table></figure>

<h4 id="Docker安装mysql"><a href="#Docker安装mysql" class="headerlink" title="Docker安装mysql"></a>Docker安装mysql</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run --name sc-mysql -d -it -p 3666:3306 -e MYSQL_ROOT_PASSWORD=123456 mysql:5.7 		#启动mysql</span><br><span class="line">docker exec -it mysql bash	#进入mysql实例</span><br><span class="line">select now(); #查询mysql时间</span><br><span class="line">show variables like &#x27;%time_zone%&#x27;; #查询当前时区</span><br><span class="line">set global time_zone=&#x27;+8:00&#x27;;  #在标准时区上加+8小时,即东8区时间</span><br><span class="line">flush privileges; #立即生效</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/17/JUC%E5%B9%B6%E5%8F%91%E5%8C%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Irvin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="随记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/17/JUC%E5%B9%B6%E5%8F%91%E5%8C%85/" class="post-title-link" itemprop="url">JUC并发包</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-17 10:36:45" itemprop="dateCreated datePublished" datetime="2020-12-17T10:36:45+08:00">2020-12-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-04 15:53:21" itemprop="dateModified" datetime="2021-08-04T15:53:21+08:00">2021-08-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JUC%E5%B9%B6%E5%8F%91%E5%8C%85/" itemprop="url" rel="index"><span itemprop="name">JUC并发包</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在JDK1.5的时候新增了JUC并发包，这个包的增加简化了多线程开发的操作难度，新增了很多多线程操作的工具类。</p>
<h3 id="JUC并发包工具类"><a href="#JUC并发包工具类" class="headerlink" title="JUC并发包工具类"></a>JUC并发包工具类</h3><h5 id="semaphore信号量"><a href="#semaphore信号量" class="headerlink" title="semaphore信号量"></a>semaphore信号量</h5><ul>
<li>一般应用于限定同时访问线程的操作数。例如：公共资源的访问，比如说开启是个线程去读取文件，然后需要将读取到的文件操作入库，但是数据库的连接资源有限，这个时候就可以使用semaphore去限定并发获取数据库连接资源的线程数。</li>
</ul>
<h5 id="countDownLatch计数器"><a href="#countDownLatch计数器" class="headerlink" title="countDownLatch计数器"></a>countDownLatch计数器</h5><ul>
<li>同步计数器，构造方法传值，用来限定计数器的次数。例如：同时启动十个线程，可以使用countDown来做计数器-1操作，await来做线程的阻塞，直到计数器为0之后在启动。</li>
</ul>
<h5 id="CyclicBarrier栅栏"><a href="#CyclicBarrier栅栏" class="headerlink" title="CyclicBarrier栅栏"></a>CyclicBarrier栅栏</h5><ul>
<li>构造方法传值来设定一个阀值，线程调用await方法的时候，线程就会阻塞。当阻塞线程达到设定的阀值的时候就会全部放行，可重置重复使用。</li>
</ul>
<h5 id="ReentrantLock可重入锁"><a href="#ReentrantLock可重入锁" class="headerlink" title="ReentrantLock可重入锁"></a>ReentrantLock可重入锁</h5><ul>
<li></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/15/java%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF%E5%8D%B7%E4%B8%80%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Irvin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="随记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/15/java%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF%E5%8D%B7%E4%B8%80%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">java核心技术卷一笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-15 09:49:59" itemprop="dateCreated datePublished" datetime="2020-12-15T09:49:59+08:00">2020-12-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-04 15:53:17" itemprop="dateModified" datetime="2021-08-04T15:53:17+08:00">2021-08-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF%E4%B9%A6%E7%B1%8D%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">技术书籍笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="格式化输出"><a href="#格式化输出" class="headerlink" title="格式化输出"></a>格式化输出</h4><p>==每个以%字符开始的格式说明符都用相应的参数替换==例如：String message = String.format(“Hello, %s. Next year, you’ll be %d”, name, age);%s用字符串来替换，%d用十进制整数来替换</p>
<p>![image-20201216092321267](/Users/zhouqiang/Library/Application Support/typora-user-images/image-20201216092321267.png)</p>
<p>![image-20201216092521650](/Users/zhouqiang/Library/Application Support/typora-user-images/image-20201216092521650.png)</p>
<p>==已t字母开头====例如：String date = String.format(“%tT”, new Date());==</p>
<p>![image-20201216094153749](/Users/zhouqiang/Library/Application Support/typora-user-images/image-20201216094153749.png)</p>
<p>![image-20201216101411774](/Users/zhouqiang/Library/Application Support/typora-user-images/image-20201216101411774.png)</p>
<h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><p>使用switch语句时可以使用javac -Xlint:fallthrough Test.java来进行编译，如果出现忘记写break结束语句的话会出现警告⚠️</p>
<p>case标签可以为char、byte、int、short、枚举常量以及JavaSE7开始出现的字符串。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/14/mysql%E8%84%9A%E6%9C%AC%E4%BA%8B%E5%8A%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Irvin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="随记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/14/mysql%E8%84%9A%E6%9C%AC%E4%BA%8B%E5%8A%A1/" class="post-title-link" itemprop="url">mysql脚本事务</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-14 10:49:51" itemprop="dateCreated datePublished" datetime="2020-12-14T10:49:51+08:00">2020-12-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-04 15:53:31" itemprop="dateModified" datetime="2021-08-04T15:53:31+08:00">2021-08-04</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="——记录执行mysql脚本时添加事务"><a href="#——记录执行mysql脚本时添加事务" class="headerlink" title="——记录执行mysql脚本时添加事务"></a>——记录执行mysql脚本时添加事务</h4><h3 id="MySQL的事务说明"><a href="#MySQL的事务说明" class="headerlink" title="MySQL的事务说明"></a>MySQL的事务说明</h3><blockquote>
<p>​    mysql中支持两种事务:InnoDB和NDB cluster,MySQL采用的是默认提交(AutoCommit)方式。</p>
</blockquote>
<h3 id="通过MySQL命令执行sql脚本时添加命令"><a href="#通过MySQL命令执行sql脚本时添加命令" class="headerlink" title="通过MySQL命令执行sql脚本时添加命令"></a>通过MySQL命令执行sql脚本时添加命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">DROP PROCEDURE IF EXISTS t_test;						# 如果存在t_test存储过程将其删除</span><br><span class="line">DELIMITER //                      					# 修改命令结束符为 // ，其实就是告诉mysql解释器，当遇见 // 后代表命令结束 </span><br><span class="line">CREATE PROCEDURE t_test()         					# 创建 t_test 存储过程开始 </span><br><span class="line">BEGIN</span><br><span class="line">DECLARE EXIT HANDLER FOR SQLEXCEPTION ROLLBACK;  # 存储过程在执行过程中如果出现异常进行回滚操作</span><br><span class="line">START TRANSACTION;                					# 事务开启</span><br><span class="line"></span><br><span class="line"># 要执行的 sql 语句</span><br><span class="line"></span><br><span class="line">COMMIT;                           					# 提交事务  </span><br><span class="line">END//                            						# 创建 t_test 存储过程结束  </span><br><span class="line">DELIMITER ;                       					# 改回默认的命令结束符 ; </span><br><span class="line">CALL t_test();                    					# 执行存储过程 </span><br></pre></td></tr></table></figure>

<h3 id="执行脚本命令"><a href="#执行脚本命令" class="headerlink" title="执行脚本命令"></a>执行脚本命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source xxx.sql</span><br><span class="line">\. xxx.sql</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/14/redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Irvin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="随记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/14/redis/" class="post-title-link" itemprop="url">redis</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-14 10:11:07" itemprop="dateCreated datePublished" datetime="2020-12-14T10:11:07+08:00">2020-12-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-04 15:53:41" itemprop="dateModified" datetime="2021-08-04T15:53:41+08:00">2021-08-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux%E5%91%BD%E4%BB%A4/" itemprop="url" rel="index"><span itemprop="name">Linux命令</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>记录本地使用redis相关命令集</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">brew services start redis 								: 启动redis服务</span><br><span class="line">brew services stop redis									: 关闭redis服务</span><br><span class="line">brew services restart redis								: 重启redis服务</span><br><span class="line">redis-cli																	: 打开图形化界面</span><br><span class="line">redis-server /usr/local/etc/redis.conf		: 使用配置文件启动redis-server</span><br><span class="line">ln -sfv /usr/local/opt/redis/*.plist ~/Library/LaunchAgents			: 开机启动redis命令</span><br><span class="line">redis-cli shutdown						: 停止redis服务</span><br><span class="line">/usr/local/etc/redis.conf			: redis配置文件位置</span><br><span class="line">brew uninstall redis rm ~/Library/LaunchAgents/homebrew.mxcl.redis.plist	: 卸载redis</span><br><span class="line">vim /usr/local/etc/redis.conf		: 允许远程访问 注释bind，默认情况下 redis不允许远程访问，只允许本机访问#bind 127.0.0.1</span><br></pre></td></tr></table></figure>

<h3 id="Docker安装redis"><a href="#Docker安装redis" class="headerlink" title="Docker安装redis"></a>Docker安装redis</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker search redis					#查询redis版本号</span><br><span class="line">docker pull redis:latest		#下载redis最新镜像</span><br><span class="line">docker images 							#查询已安装的镜像</span><br><span class="line">docker run -itd --name redis-test -p 6379:6379 redis   #左边主机端口，右边宿主机端口，通过指定才可以在本机连接</span><br><span class="line">docker ps 									#查询启动的容器</span><br><span class="line">docker rm 容器ID						 #删除容器</span><br><span class="line">docker stop 容器ID					 #停止容器</span><br></pre></td></tr></table></figure>

<h3 id="安装redis步骤"><a href="#安装redis步骤" class="headerlink" title="安装redis步骤"></a>安装redis步骤</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf redis.tar 								#解压redis</span><br><span class="line">mv redis-4.0.2 /usr/local/redis 		#移动redis到/usr/local目录下</span><br><span class="line">yum install gcc-c++									#安装gcc环境</span><br><span class="line">make																#编译	</span><br><span class="line">make install 												#安装</span><br><span class="line">nohup redis-server &amp;								#启动</span><br><span class="line">protected-mode yes									#改为no外部可以访问</span><br><span class="line">bind 127.0.0.1											#改为bind * 远程连接</span><br><span class="line">daemonize no												#默认不以守护进程方式运行 改为yes</span><br><span class="line">requirepass													#添加密码</span><br><span class="line">daemonize no</span><br><span class="line">redis-server /usr/localhost/redis/redis.cof												#启动</span><br></pre></td></tr></table></figure>

<p>![image-20210706133717138](/Users/zhouqiang/Library/Application Support/typora-user-images/image-20210706133717138.png)</p>
<p>解决办法：make MALLOC=libc 添加参数去编译</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/27/hexo-md/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Irvin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="随记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/27/hexo-md/" class="post-title-link" itemprop="url">hexo.md</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-11-27 10:00:02" itemprop="dateCreated datePublished" datetime="2020-11-27T10:00:02+08:00">2020-11-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-04 15:53:14" itemprop="dateModified" datetime="2021-08-04T15:53:14+08:00">2021-08-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/blog/" itemprop="url" rel="index"><span itemprop="name">blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>搭建blog的记录</p>
<h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">brew install node 												//安装node.js</span><br><span class="line">node -v 																	//查看node版本</span><br><span class="line">npm -v  																	//检查npm是否安装成功</span><br><span class="line">sudo npm install -g hexo-cli							//使用npm安装hexo</span><br><span class="line">cd ~/Desktop &amp;&amp; mkdir blog &amp;&amp; cd blog			//创建blog文件夹</span><br><span class="line">hexo init																	//初始化blog文件夹</span><br><span class="line">hexo s																		//预览blog命令</span><br><span class="line">hexo g																		//生成我们想要的博客文件</span><br><span class="line">hexo d																		//将本地的博客文件push到github</span><br><span class="line">hexo new firstPage.md 										//创建blog文章</span><br><span class="line">hexo n &quot;博客名称&quot;  =&gt; hexo new &quot;博客名称&quot;    //#这两个都是创建新文章，前者是简写模式</span><br><span class="line">hexo p  =&gt; hexo publish</span><br><span class="line">hexo g  =&gt; hexo generate  								//生成</span><br><span class="line">hexo s  =&gt; hexo server  									//启动服务预览</span><br><span class="line">hexo d  =&gt; hexo deploy  									//部署  </span><br><span class="line">hexo server   														//Hexo 会监视文件变动并自动更新，无须重启服务器。</span><br><span class="line">hexo server -s   													//静态模式</span><br><span class="line">hexo server -p 5000   										//更改端口</span><br><span class="line">hexo server -i 192.168.1.1   							//自定义IP</span><br><span class="line">hexo clean   															//清除缓存，网页正常情况下可以忽略此条命令</span><br><span class="line">pm2 start hexo_run.js											//后台启动blog脚本命令</span><br><span class="line">pm2 stop hexo_run.js											//后台关闭blog脚本命令</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="问题记录"><a href="#问题记录" class="headerlink" title="问题记录"></a>问题记录</h3><ol>
<li><p>配置好git之后访问404？</p>
<p>域名必须和gitHub上的名称相同，否则会出现访问404的问题</p>
</li>
</ol>
<p>搭建blog参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/nsurl/article/details/108848671">https://blog.csdn.net/nsurl/article/details/108848671</a></p>
<p>blog主题网站：<a target="_blank" rel="noopener" href="https://hexo.io/themes/">https://hexo.io/themes/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/25/ThreadLocal-md/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Irvin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="随记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/25/ThreadLocal-md/" class="post-title-link" itemprop="url">ThreadLocal</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-11-25 14:55:22" itemprop="dateCreated datePublished" datetime="2020-11-25T14:55:22+08:00">2020-11-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-04 15:53:47" itemprop="dateModified" datetime="2021-08-04T15:53:47+08:00">2021-08-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ThreadLocal/" itemprop="url" rel="index"><span itemprop="name">ThreadLocal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>记录ThreadLocal理解和使用</p>
<h2 id="ThreadLocal"><a href="#ThreadLocal" class="headerlink" title="ThreadLocal"></a>ThreadLocal</h2><h3 id="ThreadLocal定义："><a href="#ThreadLocal定义：" class="headerlink" title="ThreadLocal定义："></a>ThreadLocal定义：</h3><blockquote>
<p>threadLocal是一个线程内部的存储类，可以在指定线程内存储数据，数据存储以后只有指定的线程可以得到数据。</p>
</blockquote>
<h3 id="ThreadLocal官方解释："><a href="#ThreadLocal官方解释：" class="headerlink" title="ThreadLocal官方解释："></a>ThreadLocal官方解释：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * This class provides thread-local variables.  These variables differ from</span><br><span class="line"> * their normal counterparts in that each thread that accesses one (via its</span><br><span class="line"> * &#123;@code get&#125; or &#123;@code set&#125; method) has its own, independently initialized</span><br><span class="line"> * copy of the variable.  &#123;@code ThreadLocal&#125; instances are typically private</span><br><span class="line"> * static fields in classes that wish to associate state with a thread (e.g.,</span><br><span class="line"> * a user ID or Transaction ID).</span><br><span class="line"> */</span><br></pre></td></tr></table></figure>

<p>大致意思是threadLocal提供了线程内存储变量的能力，并且为每个使用该变量的线程提供独立的变量副本，通过get&amp;set方法就可以获取当前线程的值。</p>
<p>ThreadLocal的静态内部类ThreadLocalMap为每个Thread都维护了一个数组table，ThreadLocal确定了一个数组的下标，而这个下标就是Value存储的对应位置。</p>
<h3 id="ThreadLocal使用："><a href="#ThreadLocal使用：" class="headerlink" title="ThreadLocal使用："></a>ThreadLocal使用：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;T&gt; sThreadLocal = <span class="keyword">new</span> ThreadLocal&lt;T&gt;();</span><br><span class="line">sThreadLocal.set()</span><br><span class="line">sThreadLocal.get()</span><br></pre></td></tr></table></figure>

<p>ThreadLocal.get()：</p>
<blockquote>
<p>1、获取当前正在执行线程的ThreadLocalMap对象threadLocals。</p>
<p>2、如果Map不为空的话，从Map中获取K-V Entry节点，之后从Entry获取Value值返回。</p>
<p>3、如果Map为空的话，在Map中添加一个Value为null的值去返回，避免造成空指针。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Thread t = Thread.currentThread();</span><br><span class="line">        ThreadLocalMap map = getMap(t);</span><br><span class="line">        <span class="keyword">if</span> (map != <span class="keyword">null</span>) &#123;</span><br><span class="line">            ThreadLocalMap.Entry e = map.getEntry(<span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">                T result = (T)e.value;</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> setInitialValue();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ThreadLocalMap <span class="title">getMap</span><span class="params">(Thread t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> t.threadLocals;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> T <span class="title">setInitialValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        T value = initialValue();</span><br><span class="line">        Thread t = Thread.currentThread();</span><br><span class="line">        ThreadLocalMap map = getMap(t);</span><br><span class="line">        <span class="keyword">if</span> (map != <span class="keyword">null</span>)</span><br><span class="line">            map.set(<span class="keyword">this</span>, value);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            createMap(t, value);</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ThreadLocal.set()：</p>
<blockquote>
<p>1、从当前线程获取Map。</p>
<p>2、Map不为空时将ThreadLocal的对象和Value值存放在Map中。</p>
<p>3、Map为空时，对ThreadLocalMap进行初始化创建并存放到Map中。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">        Thread t = Thread.currentThread();</span><br><span class="line">        ThreadLocalMap map = getMap(t);</span><br><span class="line">        <span class="keyword">if</span> (map != <span class="keyword">null</span>)</span><br><span class="line">            map.set(<span class="keyword">this</span>, value);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            createMap(t, value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ThreadLocalMap <span class="title">getMap</span><span class="params">(Thread t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> t.threadLocals;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">createMap</span><span class="params">(Thread t, T firstValue)</span> </span>&#123;</span><br><span class="line">        t.threadLocals = <span class="keyword">new</span> ThreadLocalMap(<span class="keyword">this</span>, firstValue);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="ThreadLocal作用："><a href="#ThreadLocal作用：" class="headerlink" title="ThreadLocal作用："></a>ThreadLocal作用：</h3><ol>
<li>在进行对象跨层次传递的时候，使用ThreadLocal可以避免多次传递，打破层次之间的束缚。</li>
<li>线程之间的数据隔离</li>
<li>进行事务操作，用于存储线程事务信息</li>
<li>数据库连接，session会话管理</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Irvin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">18</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Irvin</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
